# Hi there üëã

## Introduction

**VAScanner/VAScanner** is the open source repository for our article ***‚ÄúDoes the Vulnerability Threaten Our Projects? Automated Vulnerable API Detection for Third-Party Libraries‚Äù***.  

We proposed **VAScanner**, a vulnerable API detection system for third-party libraries, which can precisely find vulnerable APIs used by Java projects based on comprehensive and precise vulnerable root methods.

We open source the **database** (`./DataBase`) we built which includes the vulnerable APIs mapping with vulnerable library versions and CVEs.

## Evaluation

To evaluate **VAScanner**, we conduct an experimental study on real-world projects.

### RQ1: The effectiveness of vulnerable root methods

We identify the vulnerable root methods based on two mechanisms: patch-unrelated filtering mechanism and augmentation mechanism.

Due to the lack of ground truth for vulnerable root methods mapped with CVEs, we manually analyzed the filtered patch-unrelated methods and demonstrated the rationality of augmented vulnerable root methods, to demonstrate the effectiveness.

#### Augmentation mechanism
* We summarized five patch patterns (`./result/augmentedCVE.txt`) from  patch commits where a method was added to fix a known vulnerability.
* We analyzed each added patch methods to ensure that it acts as a patch, to demonstrate the efffectiveness of augmented vulnerable root methods (`./result/augmented_vul_root.json`) based on them.

#### Patch-unrelated filtering mechanism
* We have filtered patch-unrelated methods out (`./result/filtered_method.json`) to ensure the accuracy of patch methods.

* We selected randomly 50 CVE samples (`./result/filteredCVE-sample.txt`) to analyze the effectiveness of the patch-unrelated filtering mechanism. 

* We analyzed filtered and unfiltered methods (i.e., patch methods) for each CVE sample, and generated the false positive cases and false negative cases of analysis (`./result/filter_sample_analysis.xlsx`).


### RQ2: Comparison with existing work

We demonstrate the effectiveness and superiority of VAScanner by comparing it with the state-of-the-art tool, **Eclipse Steady**, which is the only tool that provides a forward reachability analysis at the method level.

#### Dataset
* We chose the CVEs that are both maintained by Steady and VAScanner as the comparison dataset, which includes 200 CVEs and the corresponding libraries and versions. (`./dataset/LibDataSet.json`)
* We located 883 of 2,916 projects in $RQ3$ which depended on aforementioned vulnerable libraries, and used them for a fair comparison with Steady.  (`./dataset/ProjDataSet.json`)

#### Result
* The reports which were generated by VAScanner and Steady seperately are located in `./result/VAScanner` and `./result/Steady`.
* We compared the reports and generated the reports' differences between VAScanner and Steady (`./result/ReportDiff.json`).

### RQ3: Large-scale Analysis

We conducted a large-scale study on GitHub projects by leveraging VAScanner, to reveal the fact of using vulnerable APIs from vulnerable libraries in real-world projects.

#### Dataset
* We crawled 17,527 real-world projects with stars ranging from 70,000 to 0, among which 6,416 can be successfully compiled. Furthermore, we filtered projects that did not depend on the vulnerable library versions in $DataBase$, and obtained **2,916** real-world potentially vulnerable projects (`./dataset/projDataSet.json`). 

#### Result
* We detected 2,916 projects and generated reports for them (`./result/VAScanner`) by using VAScanner.
* We counted the frequency of vulnerable libraries and APIs invoked by aforementioned projects (`./result/freqLib.json`, `./result/freqMethod.json`).

